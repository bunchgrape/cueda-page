<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tool Website: Introduction & Docs</title>
    <!-- Load Tailwind CSS -->
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
    <link href="./res/tailwind.css" rel="stylesheet">
    <script>
        // Custom Tailwind Configuration for CUHK Theme Colors
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'cuhk-purple': '#532E74', // CUHK Primary Color (Violet)
                        'cuhk-gold': '#B98336',   // CUHK Accent Color (Gold)
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for the scroll behavior and sticky navigation */
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb; /* Light off-white background */
        }
        .active-link {
            /* Mapped to CUHK Gold and Purple */
            border-bottom: 2px solid #B98336; /* Gold border for active nav link */
            color: #532E74; /* Dark Purple text for active link */
            font-weight: 600;
        }
        /* Custom scrollbar for the documentation sidebar on desktop */
        #doc-sidebar::-webkit-scrollbar {
            width: 4px;
        }
        #doc-sidebar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 2px;
        }
        #doc-sidebar::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        /* Style for active doc links updated by Scrollspy */
        .doc-active-link {
            font-weight: 700;
            color: #B98336; /* CUHK Gold for active doc link */
        }

        /* --- FIX for Sticky Header: CSS Scroll Margin --- */
        /* Applies a top margin to the scroll target to reserve space for the fixed header */
        .doc-section {
            scroll-margin-top: 6rem; /* 96px, robustly covers the sticky header */
        }
    </style>
</head>
<body>

    <!-- Main Navigation Bar (Sticky at the top) -->
    <header class="sticky top-0 z-50 bg-white shadow-md" id="main-header">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center py-4">
            
            <!-- Left Side: Logo and Small Button -->
            <div class="flex items-center space-x-4">
                <!-- Logo/Tool Name (Purple base, Gold accent) -->
                <a href="#home" class="text-2xl font-bold text-gray-800 tracking-tight">
                    CU<span class="text-cuhk-gold">EDA</span>
                </a>
                
                <!-- Small Run Tool Button (CUHK Purple) -->
                <a href="#" class="text-white bg-cuhk-purple hover:bg-[#43235A] text-sm font-semibold py-1 px-3 rounded-md shadow-sm transition duration-150">
                    Run Tool
                </a>
            </div>
            
            <!-- Right Side: Navigation Links (Introduction and Documentation) -->
            <div class="flex space-x-6 text-lg">
                <!-- IMPORTANT FIX: Passing the event object and preventing default hash behavior -->
                <a href="#home" id="nav-home" class="nav-link text-gray-600 hover:text-cuhk-purple transition duration-150 py-1 active-link" onclick="showSection(event, 'home', this)">
                    Introduction
                </a>
                <a href="#docs" id="nav-docs" class="nav-link text-gray-600 hover:text-cuhk-purple transition duration-150 py-1" onclick="showSection(event, 'docs', this)">
                    Documentation
                </a>
            </div>
        </nav>
    </header>
    
    <!-- Mobile Toggle Button for Documentation Sidebar (Fixed, Upper Left, Translucent) -->
    <button id="doc-toggle-btn" class="lg:hidden inline-flex fixed top-20 left-4 z-40 bg-blue-600 text-white font-medium text-sm py-1.5 px-3 rounded-md opacity-75 hover:opacity-100 transition duration-150 shadow-lg items-center space-x-2 hidden" onclick="openDocDrawer()">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" /></svg>
        <span>Table of Contents</span>
    </button>

    <!-- Main Content Container -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">

        <!-- 1. Introduction/Home Section -->
        <section id="home" class="content-section">
            <div class="text-center py-20 bg-white rounded-xl shadow-lg border border-gray-100">
                <div class="max-w-3xl mx-auto">
                    <h1 class="text-5xl font-extrabold text-gray-900 mb-4 tracking-tight">
                        Revolutionizing <br> <span class="text-cuhk-gold">Logic Synthesis</span> <br> with GPU Acceleration
                    </h1>
                    <p class="text-xl text-gray-600 mb-8">
                        The fastest path for RTL Synthesis: Achieve <span class="text-cuhk-purple">unprecedented turnaround time</span>.
                    </p>
                    <!-- IMPORTANT FIX: Passing the event object and preventing default hash behavior -->
                    <a href="#docs" class="inline-block bg-cuhk-purple text-white text-xl font-semibold py-3 px-8 rounded-full hover:bg-[#43235A] transition duration-300 shadow-xl transform hover:scale-105" onclick="showSection(event, 'docs', document.getElementById('nav-docs'))">
                        Explore Documentation
                    </a>
                </div>
            </div>

            <!-- Feature Grid -->
            <div class="mt-16 grid md:grid-cols-3 gap-8">
                
                <!-- Advantage 1: Instant Analysis (Color neutral) -->
                <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
                    <div class="text-green-500 mb-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-2">Instant Analysis</h3>
                    <p class="text-gray-600">
                        Integrated directly as a **VS Code extension**, CUEDA provides **instant performance estimation** (Timing, Area) for your RTL modules right as you code, shortening the design-loop cycle dramatically.
                    </p>
                </div>

                <!-- Advantage 2: Ultra Fast Synthesis (Color neutral) -->
                <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
                    <div class="text-red-500 mb-3">
                        <!-- Icon: Fast Clock/Timer for Speed/GPU Acceleration -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9.879 16.121A3 3 0 1012.12 18 3 3 0 009.88 16.12z" />
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-2">Ultra Fast Synthesis</h3>
                    <p class="text-gray-600">
                        We leverage **GPU-accelerated operators** from `abc` synthesis, including `rewrite`, `balance`, `refactor`, `resub`, and more, cutting synthesis runtimes by **up to 10x** on complex designs.
                    </p>
                </div>

                <!-- Advantage 3: Industry Matching Performance (Color neutral) -->
                <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
                    <div class="text-cuhk-gold mb-3">
                        <!-- Icon: Document with Magnifying Glass for VS Code Extension -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5v2m6-2v2"/>
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke="currentColor"/>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-2">Industry Matching Performance</h3>
                    <p class="text-gray-600">
                        Our synthesized netlists deliver Quality of Results (QoR) across Timing, DRV, Power, and Area that **match or exceed** leading commercial tools like **Cadence Genus** and **Synopsys Design Compiler (DC)** on standard test benches.
                    </p>
                </div>
            </div>
        </section>

        <!-- 2. Documentation/Getting Started Section -->
        <section id="docs" class="content-section hidden">
            
            <!-- MOBILE DRAWER CONTAINER (Hidden by default, fixed position on open) -->
            <div id="mobile-doc-drawer" class="fixed inset-0 z-50 lg:hidden pointer-events-none transition-opacity duration-300 opacity-0">
                <!-- Overlay (Clickable to close) -->
                <div id="doc-overlay" class="absolute inset-0 bg-black bg-opacity-50 opacity-0 transition-opacity duration-300" onclick="closeDocDrawer()"></div>

                <!-- Drawer Menu (Sliding panel) -->
                <aside id="doc-sidebar-mobile" class="absolute left-0 top-0 h-full w-72 bg-white p-6 shadow-2xl transform -translate-x-full transition-transform duration-300">
                    <button onclick="closeDocDrawer()" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800">
                        <!-- Close X icon -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                    <!-- Nav Content for Mobile -->
                    <nav class="space-y-2 pt-6 overflow-y-auto h-full pr-2" id="doc-sidebar-mobile-nav">
                        <h4 class="text-xl font-bold text-gray-800 mb-3 border-b pb-2">Table of Contents</h4>
                        <a href="#doc-overview" class="doc-nav-link block text-gray-700 hover:text-cuhk-purple py-1 transition duration-150 text-sm font-medium" onclick="setActiveDocLink(this, true)">
                            1. Overview
                        </a>
                        <a href="#doc-installation" class="doc-nav-link block text-gray-700 hover:text-cuhk-purple py-1 transition duration-150 text-sm" onclick="setActiveDocLink(this, true)">
                            2. Installation & Setup
                        </a>
                        <a href="#doc-data-prep" class="doc-nav-link block text-gray-700 hover:text-cuhk-purple py-1 transition duration-150 text-sm" onclick="setActiveDocLink(this, true)">
                            3. Data Preparation
                        </a>
                        <a href="#doc-running" class="doc-nav-link block text-gray-700 hover:text-cuhk-purple py-1 transition duration-150 text-sm" onclick="setActiveDocLink(this, true)">
                            4. Running an Analysis
                        </a>
                        <a href="#doc-output" class="doc-nav-link block text-gray-700 hover:text-cuhk-purple py-1 transition duration-150 text-sm" onclick="setActiveDocLink(this, true)">
                            5. Interpreting Output
                        </a>
                        <a href="#doc-advanced" class="doc-nav-link block text-gray-700 hover:text-cuhk-purple py-1 transition duration-150 text-sm" onclick="setActiveDocLink(this, true)">
                            6. Advanced Features
                        </a>
                        <a href="#doc-troubleshoot" class="doc-nav-link block text-gray-700 hover:text-cuhk-purple py-1 transition duration-150 text-sm" onclick="setActiveDocLink(this, true)">
                            7. Troubleshooting
                        </a>
                    </nav>
                </aside>
            </div>

            <!-- Main Flex Container for Desktop Layout -->
            <div class="flex flex-col lg:flex-row gap-8">
                
                <!-- Left Sidebar Navigation (DESKTOP ONLY - Fixed position) -->
                <aside class="w-full lg:w-1/4 sticky lg:top-20 lg:h-96 lg:overflow-y-auto lg:pr-4 hidden lg:block bg-white p-6 rounded-xl shadow-lg border border-gray-100" id="doc-sidebar">
                    <nav class="space-y-2">
                        <h4 class="text-lg font-semibold text-gray-800 mb-3 border-b pb-2">Table of Contents</h4>
                        <a href="#doc-overview" class="doc-nav-link block text-gray-700 hover:text-cuhk-purple py-1 transition duration-150 text-sm font-medium" onclick="setActiveDocLink(this)">
                            1. Overview
                        </a>
                        <a href="#doc-installation" class="doc-nav-link block text-gray-700 hover:text-cuhk-purple py-1 transition duration-150 text-sm" onclick="setActiveDocLink(this)">
                            2. Installation & Setup
                        </a>
                        <a href="#doc-data-prep" class="doc-nav-link block text-gray-700 hover:text-cuhk-purple py-1 transition duration-150 text-sm" onclick="setActiveDocLink(this)">
                            3. Data Preparation
                        </a>
                        <a href="#doc-running" class="doc-nav-link block text-gray-700 hover:text-cuhk-purple py-1 transition duration-150 text-sm" onclick="setActiveDocLink(this)">
                            4. Running an Analysis
                        </a>
                        <a href="#doc-output" class="doc-nav-link block text-gray-700 hover:text-cuhk-purple py-1 transition duration-150 text-sm" onclick="setActiveDocLink(this)">
                            5. Interpreting Output
                        </a>
                        <a href="#doc-advanced" class="doc-nav-link block text-gray-700 hover:text-cuhk-purple py-1 transition duration-150 text-sm" onclick="setActiveDocLink(this)">
                            6. Advanced Features
                        </a>
                        <a href="#doc-troubleshoot" class="doc-nav-link block text-gray-700 hover:text-cuhk-purple py-1 transition duration-150 text-sm" onclick="setActiveDocLink(this)">
                            7. Troubleshooting
                        </a>
                    </nav>
                </aside>

                <!-- Right Documentation Content -->
                <article class="w-full lg:w-3/4 bg-white p-8 rounded-xl shadow-lg border border-gray-100">
                    <h2 class="text-3xl font-bold text-gray-900 mb-6 border-b pb-2">Getting Started & Documentation</h2>

                    <!-- 1. Overview -->
                    <section id="doc-overview" class="mb-10 doc-section">
                        <h3 class="text-2xl font-semibold text-cuhk-purple mb-3 pt-6">1. Overview</h3>
                        <p class="text-gray-700 leading-relaxed mb-4">
                            CUEDA is a state-of-the-art logic synthesis tool that drastically accelerates the Physical Design cycle using GPU-based optimization techniques. We aim to provide chip designers with the speed of hardware acceleration combined with the quality of results (QoR) expected from commercial-grade EDA tools.
                        </p>
                        <p class="text-gray-700 leading-relaxed">
                            This documentation will guide you through setting up your environment, running synthesis jobs, and maximizing the performance benefits of our GPU-accelerated flow.
                        </p>
                    </section>

                    <!-- 2. Installation & Setup -->
                    <section id="doc-installation" class="mb-10 doc-section">
                        <h3 class="text-2xl font-semibold text-cuhk-purple mb-3 pt-6">2. Installation & Setup</h3>
                        <p class="text-gray-700 leading-relaxed mb-4">
                            The CUEDA environment consists of two main components: the web-based synthesis engine and the local VS Code extension for design integration.
                        </p>
                        <h4 class="text-xl font-medium text-gray-800 mb-2">Web Engine Prerequisites</h4>
                        <ul class="list-disc list-inside space-y-1 text-gray-600 ml-4">
                            <li>Modern web browser.</li>
                            <li>Verilog or VHDL RTL design files.</li>
                            <li>Standard cell library (Liberty format, provided during setup).</li>
                        </ul>
                        <h4 class="text-xl font-medium text-gray-800 mt-4 mb-2">VS Code Extension Setup</h4>
                        <ol class="list-decimal list-inside space-y-1 text-gray-600 ml-4">
                            <li>Search for "CUEDA RTL Estimator" in the VS Code Marketplace.</li>
                            <li>Install the extension.</li>
                            <li>Configure the API endpoint in the extension settings to enable real-time analysis.</li>
                        </ol>
                    </section>

                    <!-- 3. Data Preparation -->
                    <section id="doc-data-prep" class="mb-10 doc-section">
                        <h3 class="text-2xl font-semibold text-cuhk-purple mb-3 pt-6">3. Synthesis Flow Preparation</h3>
                        <p class="text-gray-700 leading-relaxed mb-4">
                            Ensure your design files and constraints are properly structured for the synthesis engine.
                        </p>
                        <h4 class="text-xl font-medium text-gray-800 mb-2">Input Files Checklist</h4>
                        <ul class="list-disc list-inside space-y-1 text-gray-600 ml-4">
                            <li>**RTL Files:** All `.v` or `.vhdl` files for the design hierarchy.</li>
                            <li>**Constraints:** A primary SDC (Synopsys Design Constraints) file defining clocks, I/O delays, and operating conditions.</li>
                            <li>**Library:** Link to the technology library to be used for mapping.</li>
                        </ul>
                    </section>
                    
                    <!-- 4. Running an Analysis -->
                    <section id="doc-running" class="mb-10 doc-section">
                        <h3 class="text-2xl font-semibold text-cuhk-purple mb-3 pt-6">4. Running a Synthesis Job</h3>
                        <ol class="list-decimal list-inside space-y-2 text-gray-700 ml-4">
                            <li>Package your input files (RTL, SDC) into a compressed archive (.zip or .tar.gz).</li>
                            <li>Upload the archive via the "Run Tool" interface.</li>
                            <li>Select your target optimization goal (e.g., Area Minimization, Timing Closure).</li>
                            <li>Click "Start Synthesis." The GPU-accelerated process will begin immediately.</li>
                        </ol>
                    </section>

                    <!-- 5. Interpreting Output -->
                    <section id="doc-output" class="mb-10 doc-section">
                        <h3 class="text-2xl font-semibold text-cuhk-purple mb-3 pt-6">5. Interpreting Output</h3>
                        <p class="text-gray-700 leading-relaxed">
                            The output dashboard provides real-time updates on key metrics: Total Area, Critical Path Slack, Leakage Power, and DRC (Design Rule Check) violations. The final synthesized netlist (mapped to the target library) and synthesis report are available for download upon completion.
                        </p>
                    </section>

                    <!-- 6. Advanced Features -->
                    <section id="doc-advanced" class="mb-10 doc-section">
                        <h3 class="text-2xl font-semibold text-cuhk-purple mb-3 pt-6">6. Advanced Features: GPU Customization</h3>
                        <p class="text-700 leading-relaxed">
                            For experienced users, the **Advanced Settings** panel allows granular control over the GPU-accelerated `abc` commands. You can specify custom sequences and parameters for optimization operators such as `resub -K <k_value>`, `balance`, and the overall `rewrite` depth, enabling fine-tuning for specific design architectures.
                        </p>
                    </section>

                    <!-- 7. Troubleshooting -->
                    <section id="doc-troubleshoot" class="mb-10 doc-section">
                        <h3 class="text-2xl font-semibold text-cuhk-purple mb-3 pt-6">7. Troubleshooting</h3>
                        <p class="text-gray-700 leading-relaxed">
                            If you encounter a "GPU Resource Allocation Failure," please try resubmitting your job or contacting support. This typically means the assigned hardware resource is temporarily unavailable. If Timing is significantly off, double-check the syntax in your SDC file for correct clock definitions.
                        </p>
                    </section>
                </article>
            </div>
        </section>

    </main>

    <!-- Simple Footer -->
    <footer class="bg-gray-800 text-white py-6 mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-sm">
            &copy; 2025 CUEDA. All rights reserved. | <a href="#" class="hover:text-cuhk-gold">Privacy Policy</a>
        </div>
    </footer>

    <!-- JAVASCRIPT BEHAVIOR BLOCK -->
    <script>
        // Global references for Scrollspy
        let docSections = [];
        let docNavLinks = [];
        let headerElement;

        document.addEventListener('DOMContentLoaded', () => {
            // Get required elements
            headerElement = document.getElementById('main-header');
            
            // Initialize document sections and links for Scrollspy
            docSections = document.querySelectorAll('.doc-section');
            docNavLinks = document.querySelectorAll('.doc-nav-link');

            // Check the URL hash on load and show the appropriate section
            const initialHash = window.location.hash.substring(1) || 'home';
            // Note: We pass null for the event when initializing from hash
            showSection(null, initialHash, document.getElementById(`nav-${initialHash}`));
        });

        // --- Mobile Drawer Control Functions ---

        function openDocDrawer() {
            const drawerContainer = document.getElementById('mobile-doc-drawer');
            const overlay = document.getElementById('doc-overlay');
            const menu = document.getElementById('doc-sidebar-mobile');

            if (drawerContainer && overlay && menu) {
                drawerContainer.classList.remove('opacity-0', 'pointer-events-none');
                requestAnimationFrame(() => {
                    overlay.classList.remove('opacity-0');
                    menu.classList.remove('-translate-x-full');
                });
            }
        }

        function closeDocDrawer() {
            const drawerContainer = document.getElementById('mobile-doc-drawer');
            const overlay = document.getElementById('doc-overlay');
            const menu = document.getElementById('doc-sidebar-mobile');

            if (drawerContainer && overlay && menu) {
                overlay.classList.add('opacity-0');
                menu.classList.add('-translate-x-full');
                
                setTimeout(() => {
                    drawerContainer.classList.add('opacity-0', 'pointer-events-none');
                }, 300); 
            }
        }

        // --- General Navigation Functions (SPA Logic) ---
        // Changed signature to accept event first, making it optional.
        function showSection(event, sectionId, clickedElement) {
            // CRITICAL FIX: Stop the browser from executing its default anchor jump
            if (event) {
                event.preventDefault();
            }

            // Always scroll to top when switching major sections
            window.scrollTo(0, 0);

            const docToggleBtn = document.getElementById('doc-toggle-btn');
            
            // Hide all content sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('hidden');
            });

            // Show the requested section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }

            // Update active navigation link styling for the top menu
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active-link');
                link.classList.add('text-gray-600');
            });

            if (clickedElement) {
                clickedElement.classList.add('active-link');
                clickedElement.classList.remove('text-gray-600');
            }

            // CONTROL MOBILE TOC BUTTON VISIBILITY & SCROLLSPY
            if (sectionId === 'docs') {
                if (docToggleBtn) {
                    docToggleBtn.classList.remove('hidden');
                }
                document.addEventListener('scroll', handleScrollspy);

                // Set initial active doc link for visual feedback
                const firstDocLink = document.querySelector('#doc-sidebar a');
                if (firstDocLink) {
                    setActiveDocLink(firstDocLink, false, true); 
                }
            } else {
                if (docToggleBtn) {
                    docToggleBtn.classList.add('hidden');
                }
                document.removeEventListener('scroll', handleScrollspy);
            }
            
            // Update the URL hash
            history.pushState(null, null, `#${sectionId}`);
        }

        /**
         * Scrollspy logic: Tracks scroll position and updates the active link in the TOC.
         */
        function handleScrollspy() {
            let currentActiveLink = null;
            
            // The scroll threshold is set slightly larger than the header height for visibility
            const scrollThreshold = headerElement ? headerElement.offsetHeight + 10 : 150; 
            
            // Find the section currently closest to the top
            docSections.forEach(section => {
                const rect = section.getBoundingClientRect();
                
                // Check if the section top is visible within the threshold
                if (rect.top <= scrollThreshold && rect.bottom > scrollThreshold) {
                    currentActiveLink = section.id;
                }
            });

            if (currentActiveLink) {
                docNavLinks.forEach(link => {
                    const linkTarget = link.getAttribute('href').substring(1);
                    
                    // Clear previous active styles
                    link.classList.remove('doc-active-link', 'font-bold', 'text-cuhk-gold');
                    link.classList.add('text-sm');

                    // Apply new active styles
                    if (linkTarget === currentActiveLink) {
                        link.classList.add('doc-active-link', 'font-bold', 'text-cuhk-gold');
                    }
                });
            }
        }


        /**
         * Sets the active state for documentation sidebar links and scrolls to the section.
         */
        function setActiveDocLink(clickedElement, isMobileClick = false, skipScroll = false) {
            
            // Clear all previous active styles on all doc links
            docNavLinks.forEach(link => {
                link.classList.remove('doc-active-link', 'font-bold', 'text-cuhk-gold');
                link.classList.add('text-sm');
            });
            
            const targetHref = clickedElement.getAttribute('href');
            const targetId = targetHref.substring(1);
            const targetElement = document.getElementById(targetId);
            
            // Apply active styles to both matching desktop and mobile links
            document.querySelectorAll(`a[href="${targetHref}"]`).forEach(link => {
                 link.classList.add('doc-active-link', 'font-bold', 'text-cuhk-gold');
                 link.classList.remove('text-sm');
            });
            
            if (!skipScroll && targetElement) {
                // Use standard scrollIntoView. The CSS scroll-margin-top handles the offset!
                targetElement.scrollIntoView({ behavior: 'smooth' });
            }

            // Close mobile drawer if the click originated there
            if (isMobileClick) {
                closeDocDrawer();
            }
        }

        // Handle navigation when the hash changes (e.g., back/forward buttons)
        window.onhashchange = () => {
            const hash = window.location.hash.substring(1) || 'home';
            const navLink = document.getElementById(`nav-${hash}`);
            if (navLink) {
                // Note: We pass null for the event when updating from hash
                showSection(null, hash, navLink);
            }
        };

    </script>

</body>
</html>